title = "Event"
url = "/:slug"
layout = "layout"
is_hidden = 0
==

use Atlas\Events\Models\Evento;
use Atlas\Events\Models\Subscriber;

function onStart()
{
    $slug = $this->param('slug');
    $this['record'] = Evento::Where('slug', $slug)->first();

    $this->page->title = $this['record']->title;
    $this->page->description = $this['record']->description;

    $this->setHeaderBackground();
}

function setHeaderBackground()
{
    $category = $this['record']->categoria_id;

    if($category == 2) {
        $this['background_image'] = 'tech-event.jpg';
    }
}

function onSubscriptionSubmit()
{
    $record = new Subscriber();

    $record->event_id = post('event_id');
    $record->name = post('fullname');
    $record->document = post('document');
    $record->email = post('email');

    $record->save();

}

==
{% partial 'event/header' %}

<section class="section">
    <div class="container content">
        <div class="columns">
            <div class="column">
                {% partial 'event/content' %}
            </div>
            <div class="column is-3">
                {% partial 'event/form' %}
            </div>
        </div>
    </div>
</section>